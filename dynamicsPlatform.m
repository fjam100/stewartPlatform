function res=dynamicsPlatform(t,state,stewart,F0)
%% Dynamics for a stewart platform
%%state=[tx ty tz thetax thetay thetaz txd tyd tzd wx wy wz]
% state=zeros(12,1);
% stewart=StewartPlatform(state);
Fe=[0;0;0];
Fp=[0;0;0];
stewart.x=state;
H=stewart.get_H(stewart.x);
C=stewart.get_C(stewart.x);
U=stewart.get_U(stewart.x);
G=stewart.get_G(stewart.x,Fe,Fp);

t=0;
F=controlInput(t,state,stewart);

txd=state(7);
tyd=state(8);
tzd=state(9);
wx=state(10);
wy=state(11);
wz=state(12);

xd=[txd;tyd;tzd;wx;wy;wz];
xdd=inv(H)*(U*(F+F0)-G-C*xd);
res=[xd;xdd];


%% Old code for comparisons/verification

% state=zeros(12,1);
% N=external force applied to platform
% 
% m=1;%model.m;
% Ixx=1;%model.Ixx;
% Iyy=1;%model.Iyy;
% Izz=1;%model.Izz;
% Ixy=0;%model.Ixy;
% Ixz=0;%model.Ixz;
% Iyx=0;%model.Iyx;
% Iyz=0;%model.Iyz;
% Izx=0;%model.Izx;
% Izy=0;%model.Izy;
% 
% tx=state(1);
% ty=state(2);
% tz=state(3);
% thetax=state(4);
% thetay=state(5);
% thetaz=state(6);
% txd=state(7);
% tyd=state(8);
% tzd=state(9);
% wx=state(10);
% wy=state(11);
% wz=state(12);
% 
% M = [m, 0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             0; ...
% 0, m, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             0; ...
% 0, 0, m,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             0; ...
% 0, 0, 0, (cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay))*(Iyy*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)) + Iyz*(sin(thetax)*sin(thetaz) + cos(thetax)*cos(thetaz)*sin(thetay)) + Ixy*cos(thetay)*cos(thetaz)) + (sin(thetax)*sin(thetaz) + cos(thetax)*cos(thetaz)*sin(thetay))*(Iyz*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)) + Izz*(sin(thetax)*sin(thetaz) + cos(thetax)*cos(thetaz)*sin(thetay)) - Ixz*cos(thetay)*cos(thetaz)) + cos(thetay)*cos(thetaz)*(Ixy*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)) - Ixz*(sin(thetax)*sin(thetaz) + cos(thetax)*cos(thetaz)*sin(thetay)) + Ixx*cos(thetay)*cos(thetaz)), cos(thetay)*sin(thetaz)*(Ixy*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)) - Ixz*(sin(thetax)*sin(thetaz) + cos(thetax)*cos(thetaz)*sin(thetay)) + Ixx*cos(thetay)*cos(thetaz)) - (cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz))*(Iyz*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)) + Izz*(sin(thetax)*sin(thetaz) + cos(thetax)*cos(thetaz)*sin(thetay)) - Ixz*cos(thetay)*cos(thetaz)) - (cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz))*(Iyy*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)) + Iyz*(sin(thetax)*sin(thetaz) + cos(thetax)*cos(thetaz)*sin(thetay)) + Ixy*cos(thetay)*cos(thetaz)), cos(thetax)*cos(thetay)*(Iyz*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)) + Izz*(sin(thetax)*sin(thetaz) + cos(thetax)*cos(thetaz)*sin(thetay)) - Ixz*cos(thetay)*cos(thetaz)) - sin(thetay)*(Ixy*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)) - Ixz*(sin(thetax)*sin(thetaz) + cos(thetax)*cos(thetaz)*sin(thetay)) + Ixx*cos(thetay)*cos(thetaz)) - cos(thetay)*sin(thetax)*(Iyy*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)) + Iyz*(sin(thetax)*sin(thetaz) + cos(thetax)*cos(thetaz)*sin(thetay)) + Ixy*cos(thetay)*cos(thetaz)); ...
% 0, 0, 0, cos(thetay)*cos(thetaz)*(Ixz*(cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz)) - Ixy*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)) + Ixx*cos(thetay)*sin(thetaz)) - (sin(thetax)*sin(thetaz) + cos(thetax)*cos(thetaz)*sin(thetay))*(Iyz*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)) + Izz*(cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz)) + Ixz*cos(thetay)*sin(thetaz)) - (cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay))*(Iyy*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)) + Iyz*(cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz)) - Ixy*cos(thetay)*sin(thetaz)), (cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz))*(Iyy*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)) + Iyz*(cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz)) - Ixy*cos(thetay)*sin(thetaz)) + (cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz))*(Iyz*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)) + Izz*(cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz)) + Ixz*cos(thetay)*sin(thetaz)) + cos(thetay)*sin(thetaz)*(Ixz*(cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz)) - Ixy*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)) + Ixx*cos(thetay)*sin(thetaz)), cos(thetay)*sin(thetax)*(Iyy*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)) + Iyz*(cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz)) - Ixy*cos(thetay)*sin(thetaz)) - cos(thetax)*cos(thetay)*(Iyz*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)) + Izz*(cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz)) + Ixz*cos(thetay)*sin(thetaz)) - sin(thetay)*(Ixz*(cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz)) - Ixy*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)) + Ixx*cos(thetay)*sin(thetaz));
% 0, 0, 0,                                                                                                                                                                                                                                                                                     (sin(thetax)*sin(thetaz) + cos(thetax)*cos(thetaz)*sin(thetay))*(Ixz*sin(thetay) + Izz*cos(thetax)*cos(thetay) - Iyz*cos(thetay)*sin(thetax)) - (cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay))*(Ixy*sin(thetay) - Iyz*cos(thetax)*cos(thetay) + Iyy*cos(thetay)*sin(thetax)) - cos(thetay)*cos(thetaz)*(Ixx*sin(thetay) + Ixz*cos(thetax)*cos(thetay) + Ixy*cos(thetay)*sin(thetax)),                                                                                                                                                                                                                                                                                     (cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz))*(Ixy*sin(thetay) - Iyz*cos(thetax)*cos(thetay) + Iyy*cos(thetay)*sin(thetax)) - (cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz))*(Ixz*sin(thetay) + Izz*cos(thetax)*cos(thetay) - Iyz*cos(thetay)*sin(thetax)) - cos(thetay)*sin(thetaz)*(Ixx*sin(thetay) + Ixz*cos(thetax)*cos(thetay) + Ixy*cos(thetay)*sin(thetax)),                                                                                                                                                                                                                                                                                     sin(thetay)*(Ixx*sin(thetay) + Ixz*cos(thetax)*cos(thetay) + Ixy*cos(thetay)*sin(thetax)) + cos(thetax)*cos(thetay)*(Ixz*sin(thetay) + Izz*cos(thetax)*cos(thetay) - Iyz*cos(thetay)*sin(thetax)) + cos(thetay)*sin(thetax)*(Ixy*sin(thetay) - Iyz*cos(thetax)*cos(thetay) + Iyy*cos(thetay)*sin(thetax))];
% 
% C =[ 0, 0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0; ...
% 0, 0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0; ...
% 0, 0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0; ...
% 0, 0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             wz*(sin(thetay)*(Ixx*sin(thetay) + Ixz*cos(thetax)*cos(thetay) + Ixy*cos(thetay)*sin(thetax)) + cos(thetax)*cos(thetay)*(Ixz*sin(thetay) + Izz*cos(thetax)*cos(thetay) - Iyz*cos(thetay)*sin(thetax)) + cos(thetay)*sin(thetax)*(Ixy*sin(thetay) - Iyz*cos(thetax)*cos(thetay) + Iyy*cos(thetay)*sin(thetax))) - wy*((cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz))*(Ixz*sin(thetay) + Izz*cos(thetax)*cos(thetay) - Iyz*cos(thetay)*sin(thetax)) - (cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz))*(Ixy*sin(thetay) - Iyz*cos(thetax)*cos(thetay) + Iyy*cos(thetay)*sin(thetax)) + cos(thetay)*sin(thetaz)*(Ixx*sin(thetay) + Ixz*cos(thetax)*cos(thetay) + Ixy*cos(thetay)*sin(thetax))) - wx*((cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay))*(Ixy*sin(thetay) - Iyz*cos(thetax)*cos(thetay) + Iyy*cos(thetay)*sin(thetax)) - (sin(thetax)*sin(thetaz) + cos(thetax)*cos(thetaz)*sin(thetay))*(Ixz*sin(thetay) + Izz*cos(thetax)*cos(thetay) - Iyz*cos(thetay)*sin(thetax)) + cos(thetay)*cos(thetaz)*(Ixx*sin(thetay) + Ixz*cos(thetax)*cos(thetay) + Ixy*cos(thetay)*sin(thetax))), wz*(sin(thetay)*(Ixz*(cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz)) - Ixy*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)) + Ixx*cos(thetay)*sin(thetaz)) + cos(thetax)*cos(thetay)*(Iyz*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)) + Izz*(cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz)) + Ixz*cos(thetay)*sin(thetaz)) - cos(thetay)*sin(thetax)*(Iyy*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)) + Iyz*(cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz)) - Ixy*cos(thetay)*sin(thetaz))) + wx*((cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay))*(Iyy*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)) + Iyz*(cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz)) - Ixy*cos(thetay)*sin(thetaz)) + (sin(thetax)*sin(thetaz) + cos(thetax)*cos(thetaz)*sin(thetay))*(Iyz*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)) + Izz*(cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz)) + Ixz*cos(thetay)*sin(thetaz)) - cos(thetay)*cos(thetaz)*(Ixz*(cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz)) - Ixy*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)) + Ixx*cos(thetay)*sin(thetaz))) - wy*((cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz))*(Iyy*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)) + Iyz*(cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz)) - Ixy*cos(thetay)*sin(thetaz)) + (cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz))*(Iyz*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)) + Izz*(cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz)) + Ixz*cos(thetay)*sin(thetaz)) + cos(thetay)*sin(thetaz)*(Ixz*(cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz)) - Ixy*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)) + Ixx*cos(thetay)*sin(thetaz))); ...
% 0, 0, 0, wz*(sin(thetay)*(Ixz*(cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz)) - Ixy*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)) + Ixx*cos(thetay)*sin(thetaz)) + cos(thetax)*cos(thetay)*(Iyz*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)) + Izz*(cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz)) + Ixz*cos(thetay)*sin(thetaz)) - cos(thetay)*sin(thetax)*(Iyy*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)) + Iyz*(cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz)) - Ixy*cos(thetay)*sin(thetaz))) + wx*((cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay))*(Iyy*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)) + Iyz*(cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz)) - Ixy*cos(thetay)*sin(thetaz)) + (sin(thetax)*sin(thetaz) + cos(thetax)*cos(thetaz)*sin(thetay))*(Iyz*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)) + Izz*(cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz)) + Ixz*cos(thetay)*sin(thetaz)) - cos(thetay)*cos(thetaz)*(Ixz*(cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz)) - Ixy*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)) + Ixx*cos(thetay)*sin(thetaz))) - wy*((cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz))*(Iyy*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)) + Iyz*(cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz)) - Ixy*cos(thetay)*sin(thetaz)) + (cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz))*(Iyz*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)) + Izz*(cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz)) + Ixz*cos(thetay)*sin(thetaz)) + cos(thetay)*sin(thetaz)*(Ixz*(cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz)) - Ixy*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)) + Ixx*cos(thetay)*sin(thetaz))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0, wx*((cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay))*(Iyy*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)) + Iyz*(sin(thetax)*sin(thetaz) + cos(thetax)*cos(thetaz)*sin(thetay)) + Ixy*cos(thetay)*cos(thetaz)) + (sin(thetax)*sin(thetaz) + cos(thetax)*cos(thetaz)*sin(thetay))*(Iyz*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)) + Izz*(sin(thetax)*sin(thetaz) + cos(thetax)*cos(thetaz)*sin(thetay)) - Ixz*cos(thetay)*cos(thetaz)) + cos(thetay)*cos(thetaz)*(Ixy*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)) - Ixz*(sin(thetax)*sin(thetaz) + cos(thetax)*cos(thetaz)*sin(thetay)) + Ixx*cos(thetay)*cos(thetaz))) - wy*((cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz))*(Iyy*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)) + Iyz*(sin(thetax)*sin(thetaz) + cos(thetax)*cos(thetaz)*sin(thetay)) + Ixy*cos(thetay)*cos(thetaz)) + (cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz))*(Iyz*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)) + Izz*(sin(thetax)*sin(thetaz) + cos(thetax)*cos(thetaz)*sin(thetay)) - Ixz*cos(thetay)*cos(thetaz)) - cos(thetay)*sin(thetaz)*(Ixy*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)) - Ixz*(sin(thetax)*sin(thetaz) + cos(thetax)*cos(thetaz)*sin(thetay)) + Ixx*cos(thetay)*cos(thetaz))) - wz*(sin(thetay)*(Ixy*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)) - Ixz*(sin(thetax)*sin(thetaz) + cos(thetax)*cos(thetaz)*sin(thetay)) + Ixx*cos(thetay)*cos(thetaz)) - cos(thetax)*cos(thetay)*(Iyz*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)) + Izz*(sin(thetax)*sin(thetaz) + cos(thetax)*cos(thetaz)*sin(thetay)) - Ixz*cos(thetay)*cos(thetaz)) + cos(thetay)*sin(thetax)*(Iyy*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)) + Iyz*(sin(thetax)*sin(thetaz) + cos(thetax)*cos(thetaz)*sin(thetay)) + Ixy*cos(thetay)*cos(thetaz))); ...
% 0, 0, 0, wy*((cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz))*(Iyy*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)) + Iyz*(cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz)) - Ixy*cos(thetay)*sin(thetaz)) + (cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz))*(Iyz*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)) + Izz*(cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz)) + Ixz*cos(thetay)*sin(thetaz)) + cos(thetay)*sin(thetaz)*(Ixz*(cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz)) - Ixy*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)) + Ixx*cos(thetay)*sin(thetaz))) - wx*((cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay))*(Iyy*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)) + Iyz*(cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz)) - Ixy*cos(thetay)*sin(thetaz)) + (sin(thetax)*sin(thetaz) + cos(thetax)*cos(thetaz)*sin(thetay))*(Iyz*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)) + Izz*(cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz)) + Ixz*cos(thetay)*sin(thetaz)) - cos(thetay)*cos(thetaz)*(Ixz*(cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz)) - Ixy*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)) + Ixx*cos(thetay)*sin(thetaz))) - wz*(sin(thetay)*(Ixz*(cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz)) - Ixy*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)) + Ixx*cos(thetay)*sin(thetaz)) + cos(thetax)*cos(thetay)*(Iyz*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)) + Izz*(cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz)) + Ixz*cos(thetay)*sin(thetaz)) - cos(thetay)*sin(thetax)*(Iyy*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)) + Iyz*(cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz)) - Ixy*cos(thetay)*sin(thetaz))), wy*((cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz))*(Iyy*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)) + Iyz*(sin(thetax)*sin(thetaz) + cos(thetax)*cos(thetaz)*sin(thetay)) + Ixy*cos(thetay)*cos(thetaz)) + (cos(thetaz)*sin(thetax) - cos(thetax)*sin(thetay)*sin(thetaz))*(Iyz*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)) + Izz*(sin(thetax)*sin(thetaz) + cos(thetax)*cos(thetaz)*sin(thetay)) - Ixz*cos(thetay)*cos(thetaz)) - cos(thetay)*sin(thetaz)*(Ixy*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)) - Ixz*(sin(thetax)*sin(thetaz) + cos(thetax)*cos(thetaz)*sin(thetay)) + Ixx*cos(thetay)*cos(thetaz))) - wx*((cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay))*(Iyy*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)) + Iyz*(sin(thetax)*sin(thetaz) + cos(thetax)*cos(thetaz)*sin(thetay)) + Ixy*cos(thetay)*cos(thetaz)) + (sin(thetax)*sin(thetaz) + cos(thetax)*cos(thetaz)*sin(thetay))*(Iyz*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)) + Izz*(sin(thetax)*sin(thetaz) + cos(thetax)*cos(thetaz)*sin(thetay)) - Ixz*cos(thetay)*cos(thetaz)) + cos(thetay)*cos(thetaz)*(Ixy*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)) - Ixz*(sin(thetax)*sin(thetaz) + cos(thetax)*cos(thetaz)*sin(thetay)) + Ixx*cos(thetay)*cos(thetaz))) + wz*(sin(thetay)*(Ixy*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)) - Ixz*(sin(thetax)*sin(thetaz) + cos(thetax)*cos(thetaz)*sin(thetay)) + Ixx*cos(thetay)*cos(thetaz)) - cos(thetax)*cos(thetay)*(Iyz*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)) + Izz*(sin(thetax)*sin(thetaz) + cos(thetax)*cos(thetaz)*sin(thetay)) - Ixz*cos(thetay)*cos(thetaz)) + cos(thetay)*sin(thetax)*(Iyy*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)) + Iyz*(sin(thetax)*sin(thetaz) + cos(thetax)*cos(thetaz)*sin(thetay)) + Ixy*cos(thetay)*cos(thetaz))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0];
% 
% U =[                                                                                                                                                                                                                                    (tx + cos(thetay)*cos(thetaz) - 1/2)/(abs(ty + cos(thetay)*sin(thetaz) + 3^(1/2)/2)^2 + abs(tx + cos(thetay)*cos(thetaz) - 1/2)^2 + abs(tz - sin(thetay) + 1)^2)^(1/2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               (tx + (8870359658994711*cos(thetay)*cos(thetaz))/9007199254740992 - (6256334945874825*cos(thetax)*sin(thetaz))/36028797018963968 + (6256334945874825*cos(thetaz)*sin(thetax)*sin(thetay))/36028797018963968 - 1447429019731335/2251799813685248)/(abs(tz - (8870359658994711*sin(thetay))/9007199254740992 + (6256334945874825*cos(thetay)*sin(thetax))/36028797018963968 + 1)^2 + abs(tx + (8870359658994711*cos(thetay)*cos(thetaz))/9007199254740992 - (6256334945874825*cos(thetax)*sin(thetaz))/36028797018963968 + (6256334945874825*cos(thetaz)*sin(thetax)*sin(thetay))/36028797018963968 - 1447429019731335/2251799813685248)^2 + abs(ty + (6256334945874825*cos(thetax)*cos(thetaz))/36028797018963968 + (8870359658994711*cos(thetay)*sin(thetaz))/9007199254740992 + (6256334945874825*sin(thetax)*sin(thetay)*sin(thetaz))/36028797018963968 - 3449957468579869/4503599627370496)^2)^(1/2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           -((cos(thetay)*cos(thetaz))/2 - tx + (3^(1/2)*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)))/2 + 1/2)/(abs(ty - (cos(thetay)*sin(thetaz))/2 + (3^(1/2)*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)))/2 - 3^(1/2)/2)^2 + abs((cos(thetay)*cos(thetaz))/2 - tx + (3^(1/2)*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)))/2 + 1/2)^2 + abs(tz + sin(thetay)/2 + (3^(1/2)*cos(thetay)*sin(thetax))/2 + 1)^2)^(1/2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        (tx - (5789716078925341*cos(thetay)*cos(thetaz))/9007199254740992 - (6899914937159737*cos(thetax)*sin(thetaz))/9007199254740992 + (6899914937159737*cos(thetaz)*sin(thetax)*sin(thetay))/9007199254740992 + 8870359658994711/9007199254740992)/(abs(tx - (5789716078925341*cos(thetay)*cos(thetaz))/9007199254740992 - (6899914937159737*cos(thetax)*sin(thetaz))/9007199254740992 + (6899914937159737*cos(thetaz)*sin(thetax)*sin(thetay))/9007199254740992 + 8870359658994711/9007199254740992)^2 + abs(ty + (6899914937159737*cos(thetax)*cos(thetaz))/9007199254740992 - (5789716078925341*cos(thetay)*sin(thetaz))/9007199254740992 + (6899914937159737*sin(thetax)*sin(thetay)*sin(thetaz))/9007199254740992 - 6256334945874823/36028797018963968)^2 + abs(tz + (5789716078925341*sin(thetay))/9007199254740992 + (6899914937159737*cos(thetay)*sin(thetax))/9007199254740992 + 1)^2)^(1/2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        (tx - (cos(thetay)*cos(thetaz))/2 + (3^(1/2)*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)))/2 + 1)/(abs(ty - (cos(thetay)*sin(thetaz))/2 - (3^(1/2)*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)))/2 + 6523320454730237/20282409603651670423947251286016)^2 + abs(tx - (cos(thetay)*cos(thetaz))/2 + (3^(1/2)*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)))/2 + 1)^2 + abs(tz + sin(thetay)/2 - (3^(1/2)*cos(thetay)*sin(thetax))/2 + 1)^2)^(1/2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   -((3080643580069369*cos(thetay)*cos(thetaz))/9007199254740992 - tx - (2115999668407111*cos(thetax)*sin(thetaz))/2251799813685248 + (2115999668407111*cos(thetaz)*sin(thetax)*sin(thetay))/2251799813685248 + 3080643580069373/9007199254740992)/(abs((3080643580069369*cos(thetay)*cos(thetaz))/9007199254740992 - tx - (2115999668407111*cos(thetax)*sin(thetaz))/2251799813685248 + (2115999668407111*cos(thetaz)*sin(thetax)*sin(thetay))/2251799813685248 + 3080643580069373/9007199254740992)^2 + abs(tz + (3080643580069369*sin(thetay))/9007199254740992 - (2115999668407111*cos(thetay)*sin(thetax))/2251799813685248 + 1)^2 + abs((2115999668407111*cos(thetax)*cos(thetaz))/2251799813685248 - ty + (3080643580069369*cos(thetay)*sin(thetaz))/9007199254740992 + (2115999668407111*sin(thetax)*sin(thetay)*sin(thetaz))/2251799813685248 - 8463998673628443/9007199254740992)^2)^(1/2); ...
%                                                                                                                                                                                                                              (ty + cos(thetay)*sin(thetaz) + 3^(1/2)/2)/(abs(ty + cos(thetay)*sin(thetaz) + 3^(1/2)/2)^2 + abs(tx + cos(thetay)*cos(thetaz) - 1/2)^2 + abs(tz - sin(thetay) + 1)^2)^(1/2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               (ty + (6256334945874825*cos(thetax)*cos(thetaz))/36028797018963968 + (8870359658994711*cos(thetay)*sin(thetaz))/9007199254740992 + (6256334945874825*sin(thetax)*sin(thetay)*sin(thetaz))/36028797018963968 - 3449957468579869/4503599627370496)/(abs(tz - (8870359658994711*sin(thetay))/9007199254740992 + (6256334945874825*cos(thetay)*sin(thetax))/36028797018963968 + 1)^2 + abs(tx + (8870359658994711*cos(thetay)*cos(thetaz))/9007199254740992 - (6256334945874825*cos(thetax)*sin(thetaz))/36028797018963968 + (6256334945874825*cos(thetaz)*sin(thetax)*sin(thetay))/36028797018963968 - 1447429019731335/2251799813685248)^2 + abs(ty + (6256334945874825*cos(thetax)*cos(thetaz))/36028797018963968 + (8870359658994711*cos(thetay)*sin(thetaz))/9007199254740992 + (6256334945874825*sin(thetax)*sin(thetay)*sin(thetaz))/36028797018963968 - 3449957468579869/4503599627370496)^2)^(1/2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      (ty - (cos(thetay)*sin(thetaz))/2 + (3^(1/2)*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)))/2 - 3^(1/2)/2)/(abs(ty - (cos(thetay)*sin(thetaz))/2 + (3^(1/2)*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)))/2 - 3^(1/2)/2)^2 + abs((cos(thetay)*cos(thetaz))/2 - tx + (3^(1/2)*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)))/2 + 1/2)^2 + abs(tz + sin(thetay)/2 + (3^(1/2)*cos(thetay)*sin(thetax))/2 + 1)^2)^(1/2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       (ty + (6899914937159737*cos(thetax)*cos(thetaz))/9007199254740992 - (5789716078925341*cos(thetay)*sin(thetaz))/9007199254740992 + (6899914937159737*sin(thetax)*sin(thetay)*sin(thetaz))/9007199254740992 - 6256334945874823/36028797018963968)/(abs(tx - (5789716078925341*cos(thetay)*cos(thetaz))/9007199254740992 - (6899914937159737*cos(thetax)*sin(thetaz))/9007199254740992 + (6899914937159737*cos(thetaz)*sin(thetax)*sin(thetay))/9007199254740992 + 8870359658994711/9007199254740992)^2 + abs(ty + (6899914937159737*cos(thetax)*cos(thetaz))/9007199254740992 - (5789716078925341*cos(thetay)*sin(thetaz))/9007199254740992 + (6899914937159737*sin(thetax)*sin(thetay)*sin(thetaz))/9007199254740992 - 6256334945874823/36028797018963968)^2 + abs(tz + (5789716078925341*sin(thetay))/9007199254740992 + (6899914937159737*cos(thetay)*sin(thetax))/9007199254740992 + 1)^2)^(1/2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        (ty - (cos(thetay)*sin(thetaz))/2 - (3^(1/2)*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)))/2 + 6523320454730237/20282409603651670423947251286016)/(abs(ty - (cos(thetay)*sin(thetaz))/2 - (3^(1/2)*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)))/2 + 6523320454730237/20282409603651670423947251286016)^2 + abs(tx - (cos(thetay)*cos(thetaz))/2 + (3^(1/2)*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)))/2 + 1)^2 + abs(tz + sin(thetay)/2 - (3^(1/2)*cos(thetay)*sin(thetax))/2 + 1)^2)^(1/2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   -((2115999668407111*cos(thetax)*cos(thetaz))/2251799813685248 - ty + (3080643580069369*cos(thetay)*sin(thetaz))/9007199254740992 + (2115999668407111*sin(thetax)*sin(thetay)*sin(thetaz))/2251799813685248 - 8463998673628443/9007199254740992)/(abs((3080643580069369*cos(thetay)*cos(thetaz))/9007199254740992 - tx - (2115999668407111*cos(thetax)*sin(thetaz))/2251799813685248 + (2115999668407111*cos(thetaz)*sin(thetax)*sin(thetay))/2251799813685248 + 3080643580069373/9007199254740992)^2 + abs(tz + (3080643580069369*sin(thetay))/9007199254740992 - (2115999668407111*cos(thetay)*sin(thetax))/2251799813685248 + 1)^2 + abs((2115999668407111*cos(thetax)*cos(thetaz))/2251799813685248 - ty + (3080643580069369*cos(thetay)*sin(thetaz))/9007199254740992 + (2115999668407111*sin(thetax)*sin(thetay)*sin(thetaz))/2251799813685248 - 8463998673628443/9007199254740992)^2)^(1/2); ...
%                                                                                                                                                                                                                                                   (tz - sin(thetay) + 1)/(abs(ty + cos(thetay)*sin(thetaz) + 3^(1/2)/2)^2 + abs(tx + cos(thetay)*cos(thetaz) - 1/2)^2 + abs(tz - sin(thetay) + 1)^2)^(1/2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      (tz - (8870359658994711*sin(thetay))/9007199254740992 + (6256334945874825*cos(thetay)*sin(thetax))/36028797018963968 + 1)/(abs(tz - (8870359658994711*sin(thetay))/9007199254740992 + (6256334945874825*cos(thetay)*sin(thetax))/36028797018963968 + 1)^2 + abs(tx + (8870359658994711*cos(thetay)*cos(thetaz))/9007199254740992 - (6256334945874825*cos(thetax)*sin(thetaz))/36028797018963968 + (6256334945874825*cos(thetaz)*sin(thetax)*sin(thetay))/36028797018963968 - 1447429019731335/2251799813685248)^2 + abs(ty + (6256334945874825*cos(thetax)*cos(thetaz))/36028797018963968 + (8870359658994711*cos(thetay)*sin(thetaz))/9007199254740992 + (6256334945874825*sin(thetax)*sin(thetay)*sin(thetaz))/36028797018963968 - 3449957468579869/4503599627370496)^2)^(1/2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    (tz + sin(thetay)/2 + (3^(1/2)*cos(thetay)*sin(thetax))/2 + 1)/(abs(ty - (cos(thetay)*sin(thetaz))/2 + (3^(1/2)*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)))/2 - 3^(1/2)/2)^2 + abs((cos(thetay)*cos(thetaz))/2 - tx + (3^(1/2)*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)))/2 + 1/2)^2 + abs(tz + sin(thetay)/2 + (3^(1/2)*cos(thetay)*sin(thetax))/2 + 1)^2)^(1/2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              (tz + (5789716078925341*sin(thetay))/9007199254740992 + (6899914937159737*cos(thetay)*sin(thetax))/9007199254740992 + 1)/(abs(tx - (5789716078925341*cos(thetay)*cos(thetaz))/9007199254740992 - (6899914937159737*cos(thetax)*sin(thetaz))/9007199254740992 + (6899914937159737*cos(thetaz)*sin(thetax)*sin(thetay))/9007199254740992 + 8870359658994711/9007199254740992)^2 + abs(ty + (6899914937159737*cos(thetax)*cos(thetaz))/9007199254740992 - (5789716078925341*cos(thetay)*sin(thetaz))/9007199254740992 + (6899914937159737*sin(thetax)*sin(thetay)*sin(thetaz))/9007199254740992 - 6256334945874823/36028797018963968)^2 + abs(tz + (5789716078925341*sin(thetay))/9007199254740992 + (6899914937159737*cos(thetay)*sin(thetax))/9007199254740992 + 1)^2)^(1/2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              (tz + sin(thetay)/2 - (3^(1/2)*cos(thetay)*sin(thetax))/2 + 1)/(abs(ty - (cos(thetay)*sin(thetaz))/2 - (3^(1/2)*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)))/2 + 6523320454730237/20282409603651670423947251286016)^2 + abs(tx - (cos(thetay)*cos(thetaz))/2 + (3^(1/2)*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)))/2 + 1)^2 + abs(tz + sin(thetay)/2 - (3^(1/2)*cos(thetay)*sin(thetax))/2 + 1)^2)^(1/2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          (tz + (3080643580069369*sin(thetay))/9007199254740992 - (2115999668407111*cos(thetay)*sin(thetax))/2251799813685248 + 1)/(abs((3080643580069369*cos(thetay)*cos(thetaz))/9007199254740992 - tx - (2115999668407111*cos(thetax)*sin(thetaz))/2251799813685248 + (2115999668407111*cos(thetaz)*sin(thetax)*sin(thetay))/2251799813685248 + 3080643580069373/9007199254740992)^2 + abs(tz + (3080643580069369*sin(thetay))/9007199254740992 - (2115999668407111*cos(thetay)*sin(thetax))/2251799813685248 + 1)^2 + abs((2115999668407111*cos(thetax)*cos(thetaz))/2251799813685248 - ty + (3080643580069369*cos(thetay)*sin(thetaz))/9007199254740992 + (2115999668407111*sin(thetax)*sin(thetay)*sin(thetaz))/2251799813685248 - 8463998673628443/9007199254740992)^2)^(1/2); ...
%                            (sin(thetay)*(ty + cos(thetay)*sin(thetaz) + 3^(1/2)/2))/(abs(ty + cos(thetay)*sin(thetaz) + 3^(1/2)/2)^2 + abs(tx + cos(thetay)*cos(thetaz) - 1/2)^2 + abs(tz - sin(thetay) + 1)^2)^(1/2) + (cos(thetay)*sin(thetaz)*(tz - sin(thetay) + 1))/(abs(ty + cos(thetay)*sin(thetaz) + 3^(1/2)/2)^2 + abs(tx + cos(thetay)*cos(thetaz) - 1/2)^2 + abs(tz - sin(thetay) + 1)^2)^(1/2),                                                                                                                                                                                                               (((8870359658994711*sin(thetay))/9007199254740992 - (6256334945874825*cos(thetay)*sin(thetax))/36028797018963968)*(ty + (6256334945874825*cos(thetax)*cos(thetaz))/36028797018963968 + (8870359658994711*cos(thetay)*sin(thetaz))/9007199254740992 + (6256334945874825*sin(thetax)*sin(thetay)*sin(thetaz))/36028797018963968 - 3449957468579869/4503599627370496))/(abs(tz - (8870359658994711*sin(thetay))/9007199254740992 + (6256334945874825*cos(thetay)*sin(thetax))/36028797018963968 + 1)^2 + abs(tx + (8870359658994711*cos(thetay)*cos(thetaz))/9007199254740992 - (6256334945874825*cos(thetax)*sin(thetaz))/36028797018963968 + (6256334945874825*cos(thetaz)*sin(thetax)*sin(thetay))/36028797018963968 - 1447429019731335/2251799813685248)^2 + abs(ty + (6256334945874825*cos(thetax)*cos(thetaz))/36028797018963968 + (8870359658994711*cos(thetay)*sin(thetaz))/9007199254740992 + (6256334945874825*sin(thetax)*sin(thetay)*sin(thetaz))/36028797018963968 - 3449957468579869/4503599627370496)^2)^(1/2) + (((6256334945874825*cos(thetax)*cos(thetaz))/36028797018963968 + (8870359658994711*cos(thetay)*sin(thetaz))/9007199254740992 + (6256334945874825*sin(thetax)*sin(thetay)*sin(thetaz))/36028797018963968)*(tz - (8870359658994711*sin(thetay))/9007199254740992 + (6256334945874825*cos(thetay)*sin(thetax))/36028797018963968 + 1))/(abs(tz - (8870359658994711*sin(thetay))/9007199254740992 + (6256334945874825*cos(thetay)*sin(thetax))/36028797018963968 + 1)^2 + abs(tx + (8870359658994711*cos(thetay)*cos(thetaz))/9007199254740992 - (6256334945874825*cos(thetax)*sin(thetaz))/36028797018963968 + (6256334945874825*cos(thetaz)*sin(thetax)*sin(thetay))/36028797018963968 - 1447429019731335/2251799813685248)^2 + abs(ty + (6256334945874825*cos(thetax)*cos(thetaz))/36028797018963968 + (8870359658994711*cos(thetay)*sin(thetaz))/9007199254740992 + (6256334945874825*sin(thetax)*sin(thetay)*sin(thetaz))/36028797018963968 - 3449957468579869/4503599627370496)^2)^(1/2),                                                                                                               - ((sin(thetay)/2 + (3^(1/2)*cos(thetay)*sin(thetax))/2)*(ty - (cos(thetay)*sin(thetaz))/2 + (3^(1/2)*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)))/2 - 3^(1/2)/2))/(abs(ty - (cos(thetay)*sin(thetaz))/2 + (3^(1/2)*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)))/2 - 3^(1/2)/2)^2 + abs((cos(thetay)*cos(thetaz))/2 - tx + (3^(1/2)*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)))/2 + 1/2)^2 + abs(tz + sin(thetay)/2 + (3^(1/2)*cos(thetay)*sin(thetax))/2 + 1)^2)^(1/2) - (((cos(thetay)*sin(thetaz))/2 - (3^(1/2)*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)))/2)*(tz + sin(thetay)/2 + (3^(1/2)*cos(thetay)*sin(thetax))/2 + 1))/(abs(ty - (cos(thetay)*sin(thetaz))/2 + (3^(1/2)*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)))/2 - 3^(1/2)/2)^2 + abs((cos(thetay)*cos(thetaz))/2 - tx + (3^(1/2)*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)))/2 + 1/2)^2 + abs(tz + sin(thetay)/2 + (3^(1/2)*cos(thetay)*sin(thetax))/2 + 1)^2)^(1/2),                                                                                                                                                                                                               (((6899914937159737*cos(thetax)*cos(thetaz))/9007199254740992 - (5789716078925341*cos(thetay)*sin(thetaz))/9007199254740992 + (6899914937159737*sin(thetax)*sin(thetay)*sin(thetaz))/9007199254740992)*(tz + (5789716078925341*sin(thetay))/9007199254740992 + (6899914937159737*cos(thetay)*sin(thetax))/9007199254740992 + 1))/(abs(tx - (5789716078925341*cos(thetay)*cos(thetaz))/9007199254740992 - (6899914937159737*cos(thetax)*sin(thetaz))/9007199254740992 + (6899914937159737*cos(thetaz)*sin(thetax)*sin(thetay))/9007199254740992 + 8870359658994711/9007199254740992)^2 + abs(ty + (6899914937159737*cos(thetax)*cos(thetaz))/9007199254740992 - (5789716078925341*cos(thetay)*sin(thetaz))/9007199254740992 + (6899914937159737*sin(thetax)*sin(thetay)*sin(thetaz))/9007199254740992 - 6256334945874823/36028797018963968)^2 + abs(tz + (5789716078925341*sin(thetay))/9007199254740992 + (6899914937159737*cos(thetay)*sin(thetax))/9007199254740992 + 1)^2)^(1/2) - (((5789716078925341*sin(thetay))/9007199254740992 + (6899914937159737*cos(thetay)*sin(thetax))/9007199254740992)*(ty + (6899914937159737*cos(thetax)*cos(thetaz))/9007199254740992 - (5789716078925341*cos(thetay)*sin(thetaz))/9007199254740992 + (6899914937159737*sin(thetax)*sin(thetay)*sin(thetaz))/9007199254740992 - 6256334945874823/36028797018963968))/(abs(tx - (5789716078925341*cos(thetay)*cos(thetaz))/9007199254740992 - (6899914937159737*cos(thetax)*sin(thetaz))/9007199254740992 + (6899914937159737*cos(thetaz)*sin(thetax)*sin(thetay))/9007199254740992 + 8870359658994711/9007199254740992)^2 + abs(ty + (6899914937159737*cos(thetax)*cos(thetaz))/9007199254740992 - (5789716078925341*cos(thetay)*sin(thetaz))/9007199254740992 + (6899914937159737*sin(thetax)*sin(thetay)*sin(thetaz))/9007199254740992 - 6256334945874823/36028797018963968)^2 + abs(tz + (5789716078925341*sin(thetay))/9007199254740992 + (6899914937159737*cos(thetay)*sin(thetax))/9007199254740992 + 1)^2)^(1/2),                                                                                                           - ((sin(thetay)/2 - (3^(1/2)*cos(thetay)*sin(thetax))/2)*(ty - (cos(thetay)*sin(thetaz))/2 - (3^(1/2)*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)))/2 + 6523320454730237/20282409603651670423947251286016))/(abs(ty - (cos(thetay)*sin(thetaz))/2 - (3^(1/2)*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)))/2 + 6523320454730237/20282409603651670423947251286016)^2 + abs(tx - (cos(thetay)*cos(thetaz))/2 + (3^(1/2)*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)))/2 + 1)^2 + abs(tz + sin(thetay)/2 - (3^(1/2)*cos(thetay)*sin(thetax))/2 + 1)^2)^(1/2) - (((cos(thetay)*sin(thetaz))/2 + (3^(1/2)*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)))/2)*(tz + sin(thetay)/2 - (3^(1/2)*cos(thetay)*sin(thetax))/2 + 1))/(abs(ty - (cos(thetay)*sin(thetaz))/2 - (3^(1/2)*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)))/2 + 6523320454730237/20282409603651670423947251286016)^2 + abs(tx - (cos(thetay)*cos(thetaz))/2 + (3^(1/2)*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)))/2 + 1)^2 + abs(tz + sin(thetay)/2 - (3^(1/2)*cos(thetay)*sin(thetax))/2 + 1)^2)^(1/2),                                                                                                                                                                                                             (((3080643580069369*sin(thetay))/9007199254740992 - (2115999668407111*cos(thetay)*sin(thetax))/2251799813685248)*((2115999668407111*cos(thetax)*cos(thetaz))/2251799813685248 - ty + (3080643580069369*cos(thetay)*sin(thetaz))/9007199254740992 + (2115999668407111*sin(thetax)*sin(thetay)*sin(thetaz))/2251799813685248 - 8463998673628443/9007199254740992))/(abs((3080643580069369*cos(thetay)*cos(thetaz))/9007199254740992 - tx - (2115999668407111*cos(thetax)*sin(thetaz))/2251799813685248 + (2115999668407111*cos(thetaz)*sin(thetax)*sin(thetay))/2251799813685248 + 3080643580069373/9007199254740992)^2 + abs(tz + (3080643580069369*sin(thetay))/9007199254740992 - (2115999668407111*cos(thetay)*sin(thetax))/2251799813685248 + 1)^2 + abs((2115999668407111*cos(thetax)*cos(thetaz))/2251799813685248 - ty + (3080643580069369*cos(thetay)*sin(thetaz))/9007199254740992 + (2115999668407111*sin(thetax)*sin(thetay)*sin(thetaz))/2251799813685248 - 8463998673628443/9007199254740992)^2)^(1/2) - (((2115999668407111*cos(thetax)*cos(thetaz))/2251799813685248 + (3080643580069369*cos(thetay)*sin(thetaz))/9007199254740992 + (2115999668407111*sin(thetax)*sin(thetay)*sin(thetaz))/2251799813685248)*(tz + (3080643580069369*sin(thetay))/9007199254740992 - (2115999668407111*cos(thetay)*sin(thetax))/2251799813685248 + 1))/(abs((3080643580069369*cos(thetay)*cos(thetaz))/9007199254740992 - tx - (2115999668407111*cos(thetax)*sin(thetaz))/2251799813685248 + (2115999668407111*cos(thetaz)*sin(thetax)*sin(thetay))/2251799813685248 + 3080643580069373/9007199254740992)^2 + abs(tz + (3080643580069369*sin(thetay))/9007199254740992 - (2115999668407111*cos(thetay)*sin(thetax))/2251799813685248 + 1)^2 + abs((2115999668407111*cos(thetax)*cos(thetaz))/2251799813685248 - ty + (3080643580069369*cos(thetay)*sin(thetaz))/9007199254740992 + (2115999668407111*sin(thetax)*sin(thetay)*sin(thetaz))/2251799813685248 - 8463998673628443/9007199254740992)^2)^(1/2); ...
%                                - (sin(thetay)*(tx + cos(thetay)*cos(thetaz) - 1/2))/(abs(ty + cos(thetay)*sin(thetaz) + 3^(1/2)/2)^2 + abs(tx + cos(thetay)*cos(thetaz) - 1/2)^2 + abs(tz - sin(thetay) + 1)^2)^(1/2) - (cos(thetay)*cos(thetaz)*(tz - sin(thetay) + 1))/(abs(ty + cos(thetay)*sin(thetaz) + 3^(1/2)/2)^2 + abs(tx + cos(thetay)*cos(thetaz) - 1/2)^2 + abs(tz - sin(thetay) + 1)^2)^(1/2),                                                                                                                                                                                                             - (((8870359658994711*sin(thetay))/9007199254740992 - (6256334945874825*cos(thetay)*sin(thetax))/36028797018963968)*(tx + (8870359658994711*cos(thetay)*cos(thetaz))/9007199254740992 - (6256334945874825*cos(thetax)*sin(thetaz))/36028797018963968 + (6256334945874825*cos(thetaz)*sin(thetax)*sin(thetay))/36028797018963968 - 1447429019731335/2251799813685248))/(abs(tz - (8870359658994711*sin(thetay))/9007199254740992 + (6256334945874825*cos(thetay)*sin(thetax))/36028797018963968 + 1)^2 + abs(tx + (8870359658994711*cos(thetay)*cos(thetaz))/9007199254740992 - (6256334945874825*cos(thetax)*sin(thetaz))/36028797018963968 + (6256334945874825*cos(thetaz)*sin(thetax)*sin(thetay))/36028797018963968 - 1447429019731335/2251799813685248)^2 + abs(ty + (6256334945874825*cos(thetax)*cos(thetaz))/36028797018963968 + (8870359658994711*cos(thetay)*sin(thetaz))/9007199254740992 + (6256334945874825*sin(thetax)*sin(thetay)*sin(thetaz))/36028797018963968 - 3449957468579869/4503599627370496)^2)^(1/2) - (((8870359658994711*cos(thetay)*cos(thetaz))/9007199254740992 - (6256334945874825*cos(thetax)*sin(thetaz))/36028797018963968 + (6256334945874825*cos(thetaz)*sin(thetax)*sin(thetay))/36028797018963968)*(tz - (8870359658994711*sin(thetay))/9007199254740992 + (6256334945874825*cos(thetay)*sin(thetax))/36028797018963968 + 1))/(abs(tz - (8870359658994711*sin(thetay))/9007199254740992 + (6256334945874825*cos(thetay)*sin(thetax))/36028797018963968 + 1)^2 + abs(tx + (8870359658994711*cos(thetay)*cos(thetaz))/9007199254740992 - (6256334945874825*cos(thetax)*sin(thetaz))/36028797018963968 + (6256334945874825*cos(thetaz)*sin(thetax)*sin(thetay))/36028797018963968 - 1447429019731335/2251799813685248)^2 + abs(ty + (6256334945874825*cos(thetax)*cos(thetaz))/36028797018963968 + (8870359658994711*cos(thetay)*sin(thetaz))/9007199254740992 + (6256334945874825*sin(thetax)*sin(thetay)*sin(thetaz))/36028797018963968 - 3449957468579869/4503599627370496)^2)^(1/2),                                                                                                                       (((cos(thetay)*cos(thetaz))/2 + (3^(1/2)*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)))/2)*(tz + sin(thetay)/2 + (3^(1/2)*cos(thetay)*sin(thetax))/2 + 1))/(abs(ty - (cos(thetay)*sin(thetaz))/2 + (3^(1/2)*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)))/2 - 3^(1/2)/2)^2 + abs((cos(thetay)*cos(thetaz))/2 - tx + (3^(1/2)*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)))/2 + 1/2)^2 + abs(tz + sin(thetay)/2 + (3^(1/2)*cos(thetay)*sin(thetax))/2 + 1)^2)^(1/2) - ((sin(thetay)/2 + (3^(1/2)*cos(thetay)*sin(thetax))/2)*((cos(thetay)*cos(thetaz))/2 - tx + (3^(1/2)*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)))/2 + 1/2))/(abs(ty - (cos(thetay)*sin(thetaz))/2 + (3^(1/2)*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)))/2 - 3^(1/2)/2)^2 + abs((cos(thetay)*cos(thetaz))/2 - tx + (3^(1/2)*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)))/2 + 1/2)^2 + abs(tz + sin(thetay)/2 + (3^(1/2)*cos(thetay)*sin(thetax))/2 + 1)^2)^(1/2),                                                                                                                                                                                                                (((5789716078925341*cos(thetay)*cos(thetaz))/9007199254740992 + (6899914937159737*cos(thetax)*sin(thetaz))/9007199254740992 - (6899914937159737*cos(thetaz)*sin(thetax)*sin(thetay))/9007199254740992)*(tz + (5789716078925341*sin(thetay))/9007199254740992 + (6899914937159737*cos(thetay)*sin(thetax))/9007199254740992 + 1))/(abs(tx - (5789716078925341*cos(thetay)*cos(thetaz))/9007199254740992 - (6899914937159737*cos(thetax)*sin(thetaz))/9007199254740992 + (6899914937159737*cos(thetaz)*sin(thetax)*sin(thetay))/9007199254740992 + 8870359658994711/9007199254740992)^2 + abs(ty + (6899914937159737*cos(thetax)*cos(thetaz))/9007199254740992 - (5789716078925341*cos(thetay)*sin(thetaz))/9007199254740992 + (6899914937159737*sin(thetax)*sin(thetay)*sin(thetaz))/9007199254740992 - 6256334945874823/36028797018963968)^2 + abs(tz + (5789716078925341*sin(thetay))/9007199254740992 + (6899914937159737*cos(thetay)*sin(thetax))/9007199254740992 + 1)^2)^(1/2) + (((5789716078925341*sin(thetay))/9007199254740992 + (6899914937159737*cos(thetay)*sin(thetax))/9007199254740992)*(tx - (5789716078925341*cos(thetay)*cos(thetaz))/9007199254740992 - (6899914937159737*cos(thetax)*sin(thetaz))/9007199254740992 + (6899914937159737*cos(thetaz)*sin(thetax)*sin(thetay))/9007199254740992 + 8870359658994711/9007199254740992))/(abs(tx - (5789716078925341*cos(thetay)*cos(thetaz))/9007199254740992 - (6899914937159737*cos(thetax)*sin(thetaz))/9007199254740992 + (6899914937159737*cos(thetaz)*sin(thetax)*sin(thetay))/9007199254740992 + 8870359658994711/9007199254740992)^2 + abs(ty + (6899914937159737*cos(thetax)*cos(thetaz))/9007199254740992 - (5789716078925341*cos(thetay)*sin(thetaz))/9007199254740992 + (6899914937159737*sin(thetax)*sin(thetay)*sin(thetaz))/9007199254740992 - 6256334945874823/36028797018963968)^2 + abs(tz + (5789716078925341*sin(thetay))/9007199254740992 + (6899914937159737*cos(thetay)*sin(thetax))/9007199254740992 + 1)^2)^(1/2),                                                                                                                                                             ((sin(thetay)/2 - (3^(1/2)*cos(thetay)*sin(thetax))/2)*(tx - (cos(thetay)*cos(thetaz))/2 + (3^(1/2)*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)))/2 + 1))/(abs(ty - (cos(thetay)*sin(thetaz))/2 - (3^(1/2)*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)))/2 + 6523320454730237/20282409603651670423947251286016)^2 + abs(tx - (cos(thetay)*cos(thetaz))/2 + (3^(1/2)*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)))/2 + 1)^2 + abs(tz + sin(thetay)/2 - (3^(1/2)*cos(thetay)*sin(thetax))/2 + 1)^2)^(1/2) + (((cos(thetay)*cos(thetaz))/2 - (3^(1/2)*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)))/2)*(tz + sin(thetay)/2 - (3^(1/2)*cos(thetay)*sin(thetax))/2 + 1))/(abs(ty - (cos(thetay)*sin(thetaz))/2 - (3^(1/2)*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)))/2 + 6523320454730237/20282409603651670423947251286016)^2 + abs(tx - (cos(thetay)*cos(thetaz))/2 + (3^(1/2)*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)))/2 + 1)^2 + abs(tz + sin(thetay)/2 - (3^(1/2)*cos(thetay)*sin(thetax))/2 + 1)^2)^(1/2),                                                                                                                                                                                                             (((3080643580069369*cos(thetay)*cos(thetaz))/9007199254740992 - (2115999668407111*cos(thetax)*sin(thetaz))/2251799813685248 + (2115999668407111*cos(thetaz)*sin(thetax)*sin(thetay))/2251799813685248)*(tz + (3080643580069369*sin(thetay))/9007199254740992 - (2115999668407111*cos(thetay)*sin(thetax))/2251799813685248 + 1))/(abs((3080643580069369*cos(thetay)*cos(thetaz))/9007199254740992 - tx - (2115999668407111*cos(thetax)*sin(thetaz))/2251799813685248 + (2115999668407111*cos(thetaz)*sin(thetax)*sin(thetay))/2251799813685248 + 3080643580069373/9007199254740992)^2 + abs(tz + (3080643580069369*sin(thetay))/9007199254740992 - (2115999668407111*cos(thetay)*sin(thetax))/2251799813685248 + 1)^2 + abs((2115999668407111*cos(thetax)*cos(thetaz))/2251799813685248 - ty + (3080643580069369*cos(thetay)*sin(thetaz))/9007199254740992 + (2115999668407111*sin(thetax)*sin(thetay)*sin(thetaz))/2251799813685248 - 8463998673628443/9007199254740992)^2)^(1/2) - (((3080643580069369*sin(thetay))/9007199254740992 - (2115999668407111*cos(thetay)*sin(thetax))/2251799813685248)*((3080643580069369*cos(thetay)*cos(thetaz))/9007199254740992 - tx - (2115999668407111*cos(thetax)*sin(thetaz))/2251799813685248 + (2115999668407111*cos(thetaz)*sin(thetax)*sin(thetay))/2251799813685248 + 3080643580069373/9007199254740992))/(abs((3080643580069369*cos(thetay)*cos(thetaz))/9007199254740992 - tx - (2115999668407111*cos(thetax)*sin(thetaz))/2251799813685248 + (2115999668407111*cos(thetaz)*sin(thetax)*sin(thetay))/2251799813685248 + 3080643580069373/9007199254740992)^2 + abs(tz + (3080643580069369*sin(thetay))/9007199254740992 - (2115999668407111*cos(thetay)*sin(thetax))/2251799813685248 + 1)^2 + abs((2115999668407111*cos(thetax)*cos(thetaz))/2251799813685248 - ty + (3080643580069369*cos(thetay)*sin(thetaz))/9007199254740992 + (2115999668407111*sin(thetax)*sin(thetay)*sin(thetaz))/2251799813685248 - 8463998673628443/9007199254740992)^2)^(1/2); ...
%  (cos(thetay)*cos(thetaz)*(ty + cos(thetay)*sin(thetaz) + 3^(1/2)/2))/(abs(ty + cos(thetay)*sin(thetaz) + 3^(1/2)/2)^2 + abs(tx + cos(thetay)*cos(thetaz) - 1/2)^2 + abs(tz - sin(thetay) + 1)^2)^(1/2) - (cos(thetay)*sin(thetaz)*(tx + cos(thetay)*cos(thetaz) - 1/2))/(abs(ty + cos(thetay)*sin(thetaz) + 3^(1/2)/2)^2 + abs(tx + cos(thetay)*cos(thetaz) - 1/2)^2 + abs(tz - sin(thetay) + 1)^2)^(1/2), (((8870359658994711*cos(thetay)*cos(thetaz))/9007199254740992 - (6256334945874825*cos(thetax)*sin(thetaz))/36028797018963968 + (6256334945874825*cos(thetaz)*sin(thetax)*sin(thetay))/36028797018963968)*(ty + (6256334945874825*cos(thetax)*cos(thetaz))/36028797018963968 + (8870359658994711*cos(thetay)*sin(thetaz))/9007199254740992 + (6256334945874825*sin(thetax)*sin(thetay)*sin(thetaz))/36028797018963968 - 3449957468579869/4503599627370496))/(abs(tz - (8870359658994711*sin(thetay))/9007199254740992 + (6256334945874825*cos(thetay)*sin(thetax))/36028797018963968 + 1)^2 + abs(tx + (8870359658994711*cos(thetay)*cos(thetaz))/9007199254740992 - (6256334945874825*cos(thetax)*sin(thetaz))/36028797018963968 + (6256334945874825*cos(thetaz)*sin(thetax)*sin(thetay))/36028797018963968 - 1447429019731335/2251799813685248)^2 + abs(ty + (6256334945874825*cos(thetax)*cos(thetaz))/36028797018963968 + (8870359658994711*cos(thetay)*sin(thetaz))/9007199254740992 + (6256334945874825*sin(thetax)*sin(thetay)*sin(thetaz))/36028797018963968 - 3449957468579869/4503599627370496)^2)^(1/2) - (((6256334945874825*cos(thetax)*cos(thetaz))/36028797018963968 + (8870359658994711*cos(thetay)*sin(thetaz))/9007199254740992 + (6256334945874825*sin(thetax)*sin(thetay)*sin(thetaz))/36028797018963968)*(tx + (8870359658994711*cos(thetay)*cos(thetaz))/9007199254740992 - (6256334945874825*cos(thetax)*sin(thetaz))/36028797018963968 + (6256334945874825*cos(thetaz)*sin(thetax)*sin(thetay))/36028797018963968 - 1447429019731335/2251799813685248))/(abs(tz - (8870359658994711*sin(thetay))/9007199254740992 + (6256334945874825*cos(thetay)*sin(thetax))/36028797018963968 + 1)^2 + abs(tx + (8870359658994711*cos(thetay)*cos(thetaz))/9007199254740992 - (6256334945874825*cos(thetax)*sin(thetaz))/36028797018963968 + (6256334945874825*cos(thetaz)*sin(thetax)*sin(thetay))/36028797018963968 - 1447429019731335/2251799813685248)^2 + abs(ty + (6256334945874825*cos(thetax)*cos(thetaz))/36028797018963968 + (8870359658994711*cos(thetay)*sin(thetaz))/9007199254740992 + (6256334945874825*sin(thetax)*sin(thetay)*sin(thetaz))/36028797018963968 - 3449957468579869/4503599627370496)^2)^(1/2), - (((cos(thetay)*cos(thetaz))/2 + (3^(1/2)*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)))/2)*(ty - (cos(thetay)*sin(thetaz))/2 + (3^(1/2)*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)))/2 - 3^(1/2)/2))/(abs(ty - (cos(thetay)*sin(thetaz))/2 + (3^(1/2)*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)))/2 - 3^(1/2)/2)^2 + abs((cos(thetay)*cos(thetaz))/2 - tx + (3^(1/2)*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)))/2 + 1/2)^2 + abs(tz + sin(thetay)/2 + (3^(1/2)*cos(thetay)*sin(thetax))/2 + 1)^2)^(1/2) - (((cos(thetay)*sin(thetaz))/2 - (3^(1/2)*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)))/2)*((cos(thetay)*cos(thetaz))/2 - tx + (3^(1/2)*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)))/2 + 1/2))/(abs(ty - (cos(thetay)*sin(thetaz))/2 + (3^(1/2)*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)))/2 - 3^(1/2)/2)^2 + abs((cos(thetay)*cos(thetaz))/2 - tx + (3^(1/2)*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)))/2 + 1/2)^2 + abs(tz + sin(thetay)/2 + (3^(1/2)*cos(thetay)*sin(thetax))/2 + 1)^2)^(1/2), - (((5789716078925341*cos(thetay)*cos(thetaz))/9007199254740992 + (6899914937159737*cos(thetax)*sin(thetaz))/9007199254740992 - (6899914937159737*cos(thetaz)*sin(thetax)*sin(thetay))/9007199254740992)*(ty + (6899914937159737*cos(thetax)*cos(thetaz))/9007199254740992 - (5789716078925341*cos(thetay)*sin(thetaz))/9007199254740992 + (6899914937159737*sin(thetax)*sin(thetay)*sin(thetaz))/9007199254740992 - 6256334945874823/36028797018963968))/(abs(tx - (5789716078925341*cos(thetay)*cos(thetaz))/9007199254740992 - (6899914937159737*cos(thetax)*sin(thetaz))/9007199254740992 + (6899914937159737*cos(thetaz)*sin(thetax)*sin(thetay))/9007199254740992 + 8870359658994711/9007199254740992)^2 + abs(ty + (6899914937159737*cos(thetax)*cos(thetaz))/9007199254740992 - (5789716078925341*cos(thetay)*sin(thetaz))/9007199254740992 + (6899914937159737*sin(thetax)*sin(thetay)*sin(thetaz))/9007199254740992 - 6256334945874823/36028797018963968)^2 + abs(tz + (5789716078925341*sin(thetay))/9007199254740992 + (6899914937159737*cos(thetay)*sin(thetax))/9007199254740992 + 1)^2)^(1/2) - (((6899914937159737*cos(thetax)*cos(thetaz))/9007199254740992 - (5789716078925341*cos(thetay)*sin(thetaz))/9007199254740992 + (6899914937159737*sin(thetax)*sin(thetay)*sin(thetaz))/9007199254740992)*(tx - (5789716078925341*cos(thetay)*cos(thetaz))/9007199254740992 - (6899914937159737*cos(thetax)*sin(thetaz))/9007199254740992 + (6899914937159737*cos(thetaz)*sin(thetax)*sin(thetay))/9007199254740992 + 8870359658994711/9007199254740992))/(abs(tx - (5789716078925341*cos(thetay)*cos(thetaz))/9007199254740992 - (6899914937159737*cos(thetax)*sin(thetaz))/9007199254740992 + (6899914937159737*cos(thetaz)*sin(thetax)*sin(thetay))/9007199254740992 + 8870359658994711/9007199254740992)^2 + abs(ty + (6899914937159737*cos(thetax)*cos(thetaz))/9007199254740992 - (5789716078925341*cos(thetay)*sin(thetaz))/9007199254740992 + (6899914937159737*sin(thetax)*sin(thetay)*sin(thetaz))/9007199254740992 - 6256334945874823/36028797018963968)^2 + abs(tz + (5789716078925341*sin(thetay))/9007199254740992 + (6899914937159737*cos(thetay)*sin(thetax))/9007199254740992 + 1)^2)^(1/2), (((cos(thetay)*sin(thetaz))/2 + (3^(1/2)*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)))/2)*(tx - (cos(thetay)*cos(thetaz))/2 + (3^(1/2)*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)))/2 + 1))/(abs(ty - (cos(thetay)*sin(thetaz))/2 - (3^(1/2)*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)))/2 + 6523320454730237/20282409603651670423947251286016)^2 + abs(tx - (cos(thetay)*cos(thetaz))/2 + (3^(1/2)*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)))/2 + 1)^2 + abs(tz + sin(thetay)/2 - (3^(1/2)*cos(thetay)*sin(thetax))/2 + 1)^2)^(1/2) - (((cos(thetay)*cos(thetaz))/2 - (3^(1/2)*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)))/2)*(ty - (cos(thetay)*sin(thetaz))/2 - (3^(1/2)*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)))/2 + 6523320454730237/20282409603651670423947251286016))/(abs(ty - (cos(thetay)*sin(thetaz))/2 - (3^(1/2)*(cos(thetax)*cos(thetaz) + sin(thetax)*sin(thetay)*sin(thetaz)))/2 + 6523320454730237/20282409603651670423947251286016)^2 + abs(tx - (cos(thetay)*cos(thetaz))/2 + (3^(1/2)*(cos(thetax)*sin(thetaz) - cos(thetaz)*sin(thetax)*sin(thetay)))/2 + 1)^2 + abs(tz + sin(thetay)/2 - (3^(1/2)*cos(thetay)*sin(thetax))/2 + 1)^2)^(1/2), (((3080643580069369*cos(thetay)*cos(thetaz))/9007199254740992 - (2115999668407111*cos(thetax)*sin(thetaz))/2251799813685248 + (2115999668407111*cos(thetaz)*sin(thetax)*sin(thetay))/2251799813685248)*((2115999668407111*cos(thetax)*cos(thetaz))/2251799813685248 - ty + (3080643580069369*cos(thetay)*sin(thetaz))/9007199254740992 + (2115999668407111*sin(thetax)*sin(thetay)*sin(thetaz))/2251799813685248 - 8463998673628443/9007199254740992))/(abs((3080643580069369*cos(thetay)*cos(thetaz))/9007199254740992 - tx - (2115999668407111*cos(thetax)*sin(thetaz))/2251799813685248 + (2115999668407111*cos(thetaz)*sin(thetax)*sin(thetay))/2251799813685248 + 3080643580069373/9007199254740992)^2 + abs(tz + (3080643580069369*sin(thetay))/9007199254740992 - (2115999668407111*cos(thetay)*sin(thetax))/2251799813685248 + 1)^2 + abs((2115999668407111*cos(thetax)*cos(thetaz))/2251799813685248 - ty + (3080643580069369*cos(thetay)*sin(thetaz))/9007199254740992 + (2115999668407111*sin(thetax)*sin(thetay)*sin(thetaz))/2251799813685248 - 8463998673628443/9007199254740992)^2)^(1/2) - (((2115999668407111*cos(thetax)*cos(thetaz))/2251799813685248 + (3080643580069369*cos(thetay)*sin(thetaz))/9007199254740992 + (2115999668407111*sin(thetax)*sin(thetay)*sin(thetaz))/2251799813685248)*((3080643580069369*cos(thetay)*cos(thetaz))/9007199254740992 - tx - (2115999668407111*cos(thetax)*sin(thetaz))/2251799813685248 + (2115999668407111*cos(thetaz)*sin(thetax)*sin(thetay))/2251799813685248 + 3080643580069373/9007199254740992))/(abs((3080643580069369*cos(thetay)*cos(thetaz))/9007199254740992 - tx - (2115999668407111*cos(thetax)*sin(thetaz))/2251799813685248 + (2115999668407111*cos(thetaz)*sin(thetax)*sin(thetay))/2251799813685248 + 3080643580069373/9007199254740992)^2 + abs(tz + (3080643580069369*sin(thetay))/9007199254740992 - (2115999668407111*cos(thetay)*sin(thetax))/2251799813685248 + 1)^2 + abs((2115999668407111*cos(thetax)*cos(thetaz))/2251799813685248 - ty + (3080643580069369*cos(thetay)*sin(thetaz))/9007199254740992 + (2115999668407111*sin(thetax)*sin(thetay)*sin(thetaz))/2251799813685248 - 8463998673628443/9007199254740992)^2)^(1/2)];
